<html><head><title>load.lisp</title><style type='text/css'>body {background-color: #f4f4f8;}div.source {background-color: #f6f6fa; width: 75%; white-space: pre;            margin-left: 1em; margin-top: .5ex; margin-bottom: .5ex; padding-left: 1em;            border: solid; border-width: 1px;            border-top-color: #e0e0e0; border-left-color: #e0e0e0;            border-right-color: #ffffff; border-bottom-color: #ffffff;}</style></head><body><div class='source'><b>(in-package :web-user)</b></div><h2>CL-XML: How To: Loading the XML Tools</h2><p>20031024  <br/><a href='mailto:James.Anderson@setf.de'>james anderson</a></p><hr/><br/><table border='1' cellpadding='0' cellspacing='0' width='100%'>  <tr>   <td align='center'>    [<a href='#Loading'>loading</a>]    [<a href='./parse.html'>parsing</a>]    [<a href='./functional-accessors.html'>accessor functions</a>]    [<a href='./path-accessors.html'>paths</a>]    [<a href='./combined-methods.html'>combinations</a>]    [<a href='./transformations.html'>rtansformations</a>]    <a name='TOP'/></td></tr>  </table><a name='Loading'><hr/></a><h2>loading the libraries</h2><p>in order to load the cl-xml libraries, one must do three things:<ul><li>ensure that a system definition utility is present, then</li> <li>use it to load the system definition and</li> <li>to load the desired system components</li> </ul>this example loads a configuration for use without an external http library, and intends to model names with symbols. see the files "xml;load*.lisp" for other configurations.as the first step, load a definition utility, in this case, the <code>define-system</code> utility. it derives from the definition tool for cl-http, but is extended to support dependancies. the cl-xml release also includes macros which rewrite the definition forms to asdf and mk:defsystem syntax. note that these forms specify the pathnames relative to this particular file.</p><div class='source'><b>(load (merge-pathnames  (make-pathname :name "define-system" :directory   '(:relative :up :up "library"))  *load-pathname*))</b></div><p>next, tell it where to find the system description.</p><div class='source'><b>(register-system-definition :xpath (merge-pathnames  (make-pathname :name "sysdcl" :directory '(:relative :up :up))  *load-pathname*))</b></div><p>next, indicate which features one wishes the library to support. in this case specify to use symbols for xml names</p><div class='source'><b>(pushnew :xml-symbols *features*)</b></div><div class='source'><b>(setf *features* (remove :nameset-tokenizer *features*))</b></div><p>finally invoke the build process to compile and load the xpath library. since the system description declares it to depend on the document models and the parser, those modules are compiled and loaded as well</p><div class='source'><b>(execute-system-operations :xpath '(:compile :load))</b></div><p>next, define a package for the howto  code itself. this is a "user" package, which means that it is defined separate from the library packages and inherits from the library interface packages and/or imports specific symbols.</p><div class='source'><b>(defpackage :web-user (:use :common-lisp :xqdm :xmlp) (:import-from :xqdm :./* :.//* :./) (:import-from :xmlp :parse-document) (:import-from :xml-path :xpath-parser :map-nodes))</b></div><p>finally, as a check, print a list of features</p><div class='source'><b>(format *trace-output* "~%cl xml loaded:~%~s" *features*)</b></div><code>:eof</code><hr /><div class='copyright'>&#169; setf.de 20031028T161159 = <a href='./load.lisp'>load.lisp</a></div></body></html>